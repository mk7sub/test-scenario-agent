id: tc005
name: tc005_error_blocks_pass
description: ログに ERROR が含まれると PASS 不可になることを検証
expected_label: FAIL
kind: anomaly
size: small
start_at: 2026-02-13T10:40:00

events:
  - after_seconds: 0
    cmd: python reception_queue_system/control_queue.py register
    message: 受付完了 (001)

  - after_seconds: 5
    cmd: python reception_queue_system/control_queue.py start 001
    message: 001番の調理開始

  - after_seconds: 15
    cmd: python reception_queue_system/control_queue.py finish 001
    message: 001番の調理完了・呼出

  - after_seconds: 20
    cmd: >-
      python -c "from pathlib import Path; p = Path('log/app.log'); p.parent.mkdir(parents=True, exist_ok=True);
      from datetime import datetime; with p.open('a', encoding='utf-8') as fp: fp.write('ERROR 調理ラインでエラー発生\\n')"
    message: app.log に ERROR を出力して PASS 不可条件を再現
